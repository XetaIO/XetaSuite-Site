---
title: Créer une maintenance
description: Guide pour planifier et gérer les maintenances dans XetaSuite.
---

import { Steps, Aside } from '@astrojs/starlight/components';

Les maintenances permettent de suivre les interventions planifiées ou réalisées sur les équipements.

## Types de maintenance

| Type | Description |
|------|-------------|
| `PREVENTIVE` | Maintenance planifiée régulière |
| `CORRECTIVE` | Réparation suite à une panne |
| `INSPECTION` | Inspection et vérification de routine |
| `IMPROVEMENT` | Amélioration ou mise à niveau de l'équipement |
| `PREDICTIVE` | Basée sur l'analyse de données (Pas encore implémenté) |

## Statuts de maintenance

| Statut | Description |
|--------|-------------|
| `SCHEDULED` | Planifiée, non démarrée |
| `IN_PROGRESS` | En cours d'exécution |
| `COMPLETED` | Terminée avec succès |
| `CANCELLED` | Annulée |

## Réalisation de la maintenance

| Statut | Description |
|--------|-------------|
| `INTERNAL` | Réalisée par l'équipe interne |
| `EXTERNAL` | Réalisée par un prestataire externe |
| `BOTH` | Réalisée par l'interne et l'externe |

## Créer une maintenance

<Steps>

1. **Accéder au module Maintenances**

   Depuis le menu latéral, cliquez sur **Maintenances**.

2. **Cliquer sur "Nouvelle maintenance"**

3. **Sélectionner l'équipement**

   Choisissez l'équipement concerné dans la liste.

4. **Remplir les informations**

    | Champ | Obligatoire | Description |
    |-------|----------|-------------|
    | Type | ✅ | Préventive, Corrective, Inspection, Amélioration |
    | Réalisation | ✅ | Interne, Externe ou Les deux |
    | Statut | ❌ | Planifiée, En cours, Terminée, Annulée |
    | Matériel | ❌ | Équipement à maintenir |
    | Date de début | ❌ | Date prévue de l'intervention |
    | Opérateurs | ✅ | Utilisateurs assignés à la maintenance |
    | Entreprises | ✅ | Entreprises prestataires de maintenance |
    | Incidents | ❌ | Incidents liés à associer |
    | Pièces détachées | ❌ | Pièces utilisées pendant la maintenance |
    | Description | ✅ | Détails de l'intervention |
    | Raison | ✅ | Raison de la maintenance |

5. **Enregistrer**

   La maintenance est créée avec le statut `SCHEDULED`.

</Steps>

## Cycle de vie

```
SCHEDULED → IN_PROGRESS → COMPLETED
                ↓
            CANCELLED
```

## API - Créer une maintenance

### Endpoint

```http
POST /api/v1/maintenances
```

### Payload

```json
{
    "material_id": 1,
    "type": "PREVENTIVE",
    "scheduled_at": "2024-02-15T09:00:00Z",
    "description": "Révision annuelle du compresseur",
    "company_id": 5
}
```

### Réponse

```json
{
    "data": {
        "id": 1,
        "material": {
            "id": 1,
            "name": "Compresseur A1"
        },
        "type": "PREVENTIVE",
        "status": "SCHEDULED",
        "scheduled_at": "2024-02-15T09:00:00Z",
        "description": "Révision annuelle du compresseur",
        "company": {
            "id": 5,
            "name": "Tech Services Inc"
        },
        "created_by": {
            "id": 1,
            "full_name": "Jean Dupont"
        }
    }
}
```

## Mettre à jour le statut

### Démarrer l'intervention

```http
PATCH /api/v1/maintenances/{id}
```

```json
{
    "status": "IN_PROGRESS",
    "started_at": "2024-02-15T09:30:00Z"
}
```

### Terminer l'intervention

```json
{
    "status": "COMPLETED",
    "completed_at": "2024-02-15T14:00:00Z",
    "notes": "Remplacement du filtre à air et vérification du niveau d'huile."
}
```

## Permissions requises

| Action | Permission |
|--------|------------|
| Voir la liste | `maintenance.viewAny` |
| Voir une maintenance | `maintenance.view` |
| Créer | `maintenance.create` |
| Modifier | `maintenance.update` |
| Supprimer | `maintenance.delete` |
