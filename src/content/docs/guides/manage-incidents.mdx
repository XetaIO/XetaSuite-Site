---
title: Gérer les incidents
description: Guide pour signaler et gérer les incidents sur les équipements.
---

import { Steps, Aside } from '@astrojs/starlight/components';

Les incidents permettent de signaler et suivre les problèmes sur les équipements.

## Priorités

| Priorité | Description |
|----------|-------------|
| `LOW` | Impact faible, peut attendre |
| `MEDIUM` | Impact modéré, à traiter rapidement |
| `HIGH` | Impact important, urgent |
| `CRITICAL` | Bloquant, intervention immédiate |

## Statuts

| Statut | Description |
|--------|-------------|
| `OPEN` | Signalé, non pris en charge |
| `IN_PROGRESS` | En cours de résolution |
| `RESOLVED` | Résolu |
| `CLOSED` | Fermé après validation |

## Signaler un incident

<Steps>

1. **Accéder au module Incidents**

   Depuis le menu latéral, cliquez sur **Incidents**.

2. **Cliquer sur "Nouvel incident"**

3. **Remplir le formulaire**

   | Champ | Obligatoire | Description |
   |-------|----------|-------------|
   | Équipement | ✅ | Équipement concerné |
   | Titre | ✅ | Description courte |
   | Priorité | ✅ | Basse, Moyenne, Haute, Critique |
   | Description | ✅ | Détails du problème |

4. **Enregistrer**

   L'incident est créé avec le statut `OPEN`.

</Steps>

## Cycle de vie

```
OPEN → IN_PROGRESS → RESOLVED → CLOSED
          ↓             ↓
        OPEN ←────────┘
```

<Aside type="note">
  Un incident peut être rouvert (`OPEN`) depuis `IN_PROGRESS` ou `RESOLVED` si le problème persiste.
</Aside>

## API - Signaler un incident

### Endpoint

```http
POST /api/v1/incidents
```

### Payload

```json
{
    "material_id": 1,
    "title": "Bruit anormal sur compresseur",
    "priority": "HIGH",
    "description": "Le compresseur émet un bruit de claquement depuis ce matin. Fonctionnement dégradé."
}
```

### Réponse

```json
{
    "data": {
        "id": 1,
        "material": {
            "id": 1,
            "name": "Compresseur A1"
        },
        "title": "Bruit anormal sur compresseur",
        "priority": "HIGH",
        "status": "OPEN",
        "description": "Le compresseur émet un bruit...",
        "reported_by": {
            "id": 5,
            "full_name": "Jean Dupont"
        },
        "created_at": "2024-01-15T08:30:00Z"
    }
}
```

## Mettre à jour le statut de l'incident

### Prendre en charge

```http
PATCH /api/v1/incidents/{id}
```

```json
{
    "status": "IN_PROGRESS",
    "assigned_to": 3
}
```

### Résoudre

```json
{
    "status": "RESOLVED",
    "resolution": "Remplacement du roulement usé. Bruit éliminé."
}
```

### Fermer

```json
{
    "status": "CLOSED"
}
```

## Lier à une maintenance

Un incident peut déclencher une maintenance :

```http
POST /api/v1/maintenances
```

```json
{
    "material_id": 1,
    "type": "CORRECTIVE",
    "incident_id": 1,
    "scheduled_at": "2024-01-15T14:00:00Z",
    "description": "Réparation suite à l'incident #1"
}
```

## Permissions requises

| Action | Permission |
|--------|------------|
| Voir la liste | `incident.viewAny` |
| Voir un incident | `incident.view` |
| Créer | `incident.create` |
| Modifier | `incident.update` |
| Supprimer | `incident.delete` |

## Filtres

```http
GET /api/v1/incidents?status=OPEN&priority=HIGH&material_id=1
```
